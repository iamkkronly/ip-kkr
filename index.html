<script>
    function getIP() {
        let ipInfoDiv = document.getElementById("ip-info");
        let loggingUrl = "YOUR_GOOGLE_APPS_SCRIPT_URL"; // Replace with your Web App URL
        ipInfoDiv.innerHTML = "<p>Loading...</p>";

        fetch('https://api64.ipify.org?format=json')
        .then(response => response.json())
        .then(data => {
            let ip = data.ip;
            return fetch(`https://ipapi.co/${ip}/json/`);
        })
        .then(response => response.json())
        .then(data => {
            let ipDetails = {
                ip: data.ip,
                city: data.city,
                region: data.region,
                country: data.country_name,
                isp: data.org,
                latitude: data.latitude,
                longitude: data.longitude
            };

            // Display details
            ipInfoDiv.innerHTML = `
                <h3>IP Address: ${ipDetails.ip}</h3>
                <p><strong>City:</strong> ${ipDetails.city}</p>
                <p><strong>Region:</strong> ${ipDetails.region}</p>
                <p><strong>Country:</strong> ${ipDetails.country}</p>
                <p><strong>ISP:</strong> ${ipDetails.isp}</p>
                <p><strong>Latitude:</strong> ${ipDetails.latitude}</p>
                <p><strong>Longitude:</strong> ${ipDetails.longitude}</p>
            `;

            // Send data to Google Sheets
            fetch(loggingUrl, {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify(ipDetails)
            });

        })
        .catch(() => ipInfoDiv.innerHTML = "Error fetching details!");
    }
</script>
